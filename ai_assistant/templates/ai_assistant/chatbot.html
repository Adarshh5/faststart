

{% extends 'core/base.html' %}
{% load static %}

{% block extra_css %}
<link href="{% static 'ai_assistant/css/chatbot.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}
<section class="chatbot-section">
    <div class="container-fluid h-100 p-0">
        <div class="chat-container d-flex flex-column h-100">
            <!-- Chat Header -->
            <div class="chat-header py-3">
                <div class="d-flex align-items-center justify-content-between">
                    <h3 class="chat-title mb-0">AI Assistant</h3>
                    <div class="usage-indicator">
                        <i class="fas fa-comment me-2"></i>
                        <span id="messageCount">0/8</span>
                    </div>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chatBox" class="chat-box flex-grow-1">
                {% for msg in chat_history %}
                <div class="message {{ msg.type }}">
                    {{ msg.content }}
                    {% if msg.translation and msg.type == 'ai' %}
                    <div class="translation">{{ msg.translation }}</div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>

            <!-- Input Area -->
            <form id="chatForm" class="chat-input" data-url="{% url 'Chatbot' %}">
                {% csrf_token %}
                <div class="input-group">
                    <input type="text" id="userInput" name="user_message" 
                        class="form-control" 
                        placeholder="Type your message..." 
                        autocomplete="off" required>
                    <button type="button" id="speakBtn" class="btn btn-voice">
                        <i class="fas fa-microphone"></i>
                    </button>
                    <button type="submit" class="btn btn-send">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'ai_assistant/js/chatbot.js' %}"></script>
{% endblock %}